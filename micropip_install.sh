#!/bin/bash

# Function to check and set proxy environment variables
function set_proxy() {
    # Load environment variables from /etc/environment if it exists
    if [ -f /etc/environment ]; then
        source /etc/environment
    fi

    # List of proxy environment variables to check
    PROXY_VARS=("http_proxy" "https_proxy" "ftp_proxy" "rsync_proxy" "no_proxy")

    for var in "${PROXY_VARS[@]}"; do
        # Check if the variable is set and not empty
        if [ -n "${!var}" ]; then
            # If the variable does not start with "http://" or "https://", add "http://"
            if [[ "${!var}" != http://* && "${!var}" != https://* ]]; then
                export $var="http://${!var}"
            else
                export $var="${!var}"
            fi
        fi
    done
}

# Call the function to set proxy variables
set_proxy

# Base URL for the Pyodide packages
BASE_URL="https://cdn.jsdelivr.net/pyodide/v0.26.3/full/"

# List of the missing .whl files to download
FILES=("aiohttp-3.9.5-cp312-cp312-pyodide_2024_0_wasm32.whl"
"aiohttp-tests.tar"
"aiosignal-1.3.1-py3-none-any.whl"
"altair-5.3.0-py3-none-any.whl"
"annotated_types-0.6.0-py3-none-any.whl"
"annotated-types-tests.tar"
"asciitree-0.3.3-py3-none-any.whl"
"astropy-6.0.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"astropy_iers_data-0.2024.4.22.0.29.50-py3-none-any.whl"
"astropy_iers_data-tests.tar"
"asttokens-2.4.1-py2.py3-none-any.whl"
"async_timeout-4.0.3-py3-none-any.whl"
"atomicwrites-1.4.1-py2.py3-none-any.whl"
"attrs-23.2.0-py3-none-any.whl"
"autograd-1.6.2-py3-none-any.whl"
"autograd-tests.tar"
"awkward_cpp-33-cp312-cp312-pyodide_2024_0_wasm32.whl"
"b2d-0.7.4-cp312-cp312-pyodide_2024_0_wasm32.whl"
"bcrypt-4.1.2-cp312-cp312-pyodide_2024_0_wasm32.whl"
"beautifulsoup4-4.12.3-py3-none-any.whl"
"beautifulsoup4-tests.tar"
"biopython-1.83-cp312-cp312-pyodide_2024_0_wasm32.whl"
"bitarray-2.9.2-cp312-cp312-pyodide_2024_0_wasm32.whl"
"bitarray-tests.tar"
"bitstring-4.1.4-py3-none-any.whl"
"bleach-6.1.0-py3-none-any.whl"
"bokeh-3.4.1-py3-none-any.whl"
"boost_histogram-1.4.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"Brotli-1.1.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"cachetools-5.3.3-py3-none-any.whl"
"Cartopy-0.23.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"Cartopy-tests.tar"
"cbor_diag-1.0.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"certifi-2024.2.2-py3-none-any.whl"
"cffi-1.16.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"cffi_example-0.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"cftime-1.6.3-cp312-cp312-pyodide_2024_0_wasm32.whl"
"charset_normalizer-3.3.2-py3-none-any.whl"
"clarabel-0.7.1-cp37-abi3-pyodide_2024_0_wasm32.whl"
"click-8.1.7-py3-none-any.whl"
"cligj-0.7.2-py3-none-any.whl"
"cloudpickle-3.0.0-py3-none-any.whl"
"cmyt-2.0.0-py3-none-any.whl"
"cmyt-tests.tar"
"colorspacious-1.1.2-py2.py3-none-any.whl"
"contourpy-1.2.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"CoolProp-6.6.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"coolprop-tests.tar"
"coverage-7.4.4-cp312-cp312-pyodide_2024_0_wasm32.whl"
"cpp-exceptions-test-0.1.zip"
"cpp_exceptions_test2-1.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"cramjam-2.8.3-cp312-cp312-pyodide_2024_0_wasm32.whl"
"crc32c-2.4-cp312-cp312-pyodide_2024_0_wasm32.whl"
"cryptography-42.0.5-cp312-cp312-pyodide_2024_0_wasm32.whl"
"cssselect-1.2.0-py2.py3-none-any.whl"
"cvxpy_base-1.5.1-py3-none-any.whl"
"cvxpy-base-tests.tar"
"cycler-0.12.1-py3-none-any.whl"
"cysignals-1.11.4-cp312-cp312-pyodide_2024_0_wasm32.whl"
"cytoolz-0.12.3-cp312-cp312-pyodide_2024_0_wasm32.whl"
"cytoolz-tests.tar"
"decorator-5.1.1-py3-none-any.whl"
"demes-0.2.3-py3-none-any.whl"
"deprecation-2.1.0-py2.py3-none-any.whl"
"distlib-0.3.8-py2.py3-none-any.whl"
"docutils-0.21.1-py3-none-any.whl"
"ewah_bool_utils-1.2.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"ewah_bool_utils-tests.tar"
"exceptiongroup-1.2.1-py3-none-any.whl"
"executing-2.0.1-py2.py3-none-any.whl"
"fastparquet-2024.2.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"fiona-1.9.5-cp312-cp312-pyodide_2024_0_wasm32.whl"
"fiona-tests.tar"
"fonttools-4.51.0-py3-none-any.whl"
"fpcast_test-0.1.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"freesasa-2.2.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"frozenlist-1.4.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"fsspec-2024.3.1-py3-none-any.whl"
"fsspec-tests.tar"
"future-1.0.0-py3-none-any.whl"
"future-tests.tar"
"galpy-1.9.2-cp312-cp312-pyodide_2024_0_wasm32.whl"
"gdal-3.8.3.zip"
"gensim-4.3.2-cp312-cp312-pyodide_2024_0_wasm32.whl"
"gensim-tests.tar"
"geopandas-0.14.3-py3-none-any.whl"
"geopandas-tests.tar"
"geos-3.12.1.zip"
"gmpy2-2.1.5-cp312-cp312-pyodide_2024_0_wasm32.whl"
"gsw-3.6.17-cp312-cp312-pyodide_2024_0_wasm32.whl"
"gsw-tests.tar"
"h5py-3.11.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"h5py-tests.tar"
"hashlib-1.0.0.zip"
"html5lib-1.1-py2.py3-none-any.whl"
"idna-3.7-py3-none-any.whl"
"igraph-0.11.4-cp39-abi3-pyodide_2024_0_wasm32.whl"
"imageio-2.34.1-py3-none-any.whl"
"iniconfig-2.0.0-py3-none-any.whl"
"ipython-8.23.0-py3-none-any.whl"
"ipython-tests.tar"
"jedi-0.19.1-py2.py3-none-any.whl"
"jedi-tests.tar"
"Jinja2-3.1.3-py3-none-any.whl"
"joblib-1.4.0-py3-none-any.whl"
"joblib-tests.tar"
"jsonschema-4.21.1-py3-none-any.whl"
"jsonschema_specifications-2023.12.1-py3-none-any.whl"
"jsonschema_specifications-tests.tar"
"jsonschema-tests.tar"
"kiwisolver-1.4.5-cp312-cp312-pyodide_2024_0_wasm32.whl"
"lakers_python-0.3.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"lazy_loader-0.4-py3-none-any.whl"
"lazy_loader-tests.tar"
"lazy_object_proxy-1.10.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"libcst-1.3.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"libcst-tests.tar"
"libhdf5-1.12.1.zip"
"libheif-1.12.0.zip"
"libmagic-5.42.zip"
"libnetcdf-4.9.2.zip"
"lightgbm-4.3.0-py3-none-pyodide_2024_0_wasm32.whl"
"Logbook-1.7.0.post0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"lxml-5.2.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"lzma-1.0.0.zip"
"MarkupSafe-2.1.5-cp312-cp312-pyodide_2024_0_wasm32.whl"
"matplotlib-3.5.2-cp312-cp312-pyodide_2024_0_wasm32.whl"
"matplotlib_inline-0.1.7-py3-none-any.whl"
"matplotlib_pyodide-0.2.2-py3-none-any.whl"
"matplotlib-tests.tar"
"memory_allocator-0.1.4-cp312-cp312-pyodide_2024_0_wasm32.whl"
"micropip-0.6.0-py3-none-any.whl"
"mmh3-4.1.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"mne-1.7.0-py3-none-any.whl"
"mne-tests.tar"
"more_itertools-10.2.0-py3-none-any.whl"
"mpmath-1.3.0-py3-none-any.whl"
"mpmath-tests.tar"
"msgpack-1.0.8-cp312-cp312-pyodide_2024_0_wasm32.whl"
"msgspec-0.18.6-cp312-cp312-pyodide_2024_0_wasm32.whl"
"msprime-1.3.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"multidict-6.0.5-cp312-cp312-pyodide_2024_0_wasm32.whl"
"munch-4.0.0-py2.py3-none-any.whl"
"mypy-1.9.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"mypy-tests.tar"
"netCDF4-1.6.5-cp312-cp312-pyodide_2024_0_wasm32.whl"
"networkx-3.3-py3-none-any.whl"
"networkx-tests.tar"
"newick-1.9.0-py2.py3-none-any.whl"
"nh3-0.2.17-cp37-abi3-pyodide_2024_0_wasm32.whl"
"nlopt-2.7.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"nltk-3.8.1-py3-none-any.whl"
"nltk-tests.tar"
"numcodecs-0.11.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"numcodecs-tests.tar"
"numpy-1.26.4-cp312-cp312-pyodide_2024_0_wasm32.whl"
"numpy-tests.tar"
"openblas-0.3.26.zip"
"opencv_python-4.9.0.80-cp312-cp312-pyodide_2024_0_wasm32.whl"
"openssl-1.1.1n.zip"
"optlang-1.8.1-py2.py3-none-any.whl"
"optlang-tests.tar"
"orjson-3.10.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"packaging-23.2-py3-none-any.whl"
"pandas-2.2.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pandas-tests.tar"
"parso-0.8.4-py2.py3-none-any.whl"
"patsy-0.5.6-py2.py3-none-any.whl"
"patsy-tests.tar"
"peewee-3.17.3-py3-none-any.whl"
"peewee-tests.tar"
"pillow-10.2.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pillow_heif-0.8.0-cp36-abi3-pyodide_2024_0_wasm32.whl"
"pkgconfig-1.5.5-py3-none-any.whl"
"pluggy-1.5.0-py3-none-any.whl"
"pplpy-0.8.10-cp312-cp312-pyodide_2024_0_wasm32.whl"
"primecountpy-0.1.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"prompt_toolkit-3.0.43-py3-none-any.whl"
"protobuf-4.24.4-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pure_eval-0.2.2-py3-none-any.whl"
"py-1.11.0-py2.py3-none-any.whl"
"pyclipper-1.3.0.post5-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pycparser-2.22-py3-none-any.whl"
"pycryptodome-3.20.0-cp35-abi3-pyodide_2024_0_wasm32.whl"
"pycryptodome-tests.tar"
"pydantic-2.7.0-py3-none-any.whl"
"pydantic_core-2.18.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pydecimal-1.0.0.zip"
"pydoc_data-1.0.0.zip"
"pyerfa-2.0.1.4-cp39-abi3-pyodide_2024_0_wasm32.whl"
"pyerfa-tests.tar"
"pygame_ce-2.4.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pygame-ce-tests.tar"
"pygments-2.17.2-py3-none-any.whl"
"pyheif-0.7.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pyiceberg-0.6.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pyinstrument-4.4.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"PyNaCl-1.5.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pyodide_http-0.2.1-py3-none-any.whl"
"pyparsing-3.1.2-py3-none-any.whl"
"pyproj-3.6.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pyrsistent-0.20.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pysam-0.22.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pyshp-2.3.1-py2.py3-none-any.whl"
"pytest-8.1.1-py3-none-any.whl"
"pytest_asyncio-0.23.7-py3-none-any.whl"
"pytest_benchmark-4.0.0-py3-none-any.whl"
"python_dateutil-2.9.0.post0-py2.py3-none-any.whl"
"python_flint-0.6.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"python_magic-0.4.27-py2.py3-none-any.whl"
"python_sat-1.8.dev13-cp312-cp312-pyodide_2024_0_wasm32.whl"
"python_solvespace-3.0.8-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pytz-2024.1-py2.py3-none-any.whl"
"pywavelets-1.6.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"pywavelets-tests.tar"
"pyxel-1.9.10-cp37-abi3-pyodide_2024_0_wasm32.whl"
"pyxirr-0.10.3-cp312-cp312-pyodide_2024_0_wasm32.whl"
"PyYAML-6.0.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"rebound-3.24.2-cp312-cp312-pyodide_2024_0_wasm32.whl"
"reboundx-3.10.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"referencing-0.34.0-py3-none-any.whl"
"referencing-tests.tar"
"regex-2024.4.16-cp312-cp312-pyodide_2024_0_wasm32.whl"
"regex-tests.tar"
"requests-2.31.0-py3-none-any.whl"
"retrying-1.3.4-py3-none-any.whl"
"rich-13.7.1-py3-none-any.whl"
"river-0.19.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"river-tests.tar"
"RobotRaconteur-1.2.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"rpds_py-0.18.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"ruamel.yaml-0.18.6-py3-none-any.whl"
"rust_panic_test-1.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"scikit_image-0.23.2-cp312-cp312-pyodide_2024_0_wasm32.whl"
"scikit-image-tests.tar"
"scikit_learn-1.4.2-cp312-cp312-pyodide_2024_0_wasm32.whl"
"scikit-learn-tests.tar"
"scipy-1.12.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"scipy-tests.tar"
"screed-1.1.3-py2.py3-none-any.whl"
"screed-tests.tar"
"setuptools-69.5.1-py3-none-any.whl"
"shapely-2.0.2-cp312-cp312-pyodide_2024_0_wasm32.whl"
"shapely-tests.tar"
"sharedlib-test-1.0.zip"
"sharedlib_test_py-1.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"simplejson-3.19.2-cp312-cp312-pyodide_2024_0_wasm32.whl"
"simplejson-tests.tar"
"sisl-0.14.3-cp312-cp312-pyodide_2024_0_wasm32.whl"
"sisl-tests.tar"
"six-1.16.0-py2.py3-none-any.whl"
"smart_open-7.0.4-py3-none-any.whl"
"sortedcontainers-2.4.0-py2.py3-none-any.whl"
"soupsieve-2.5-py3-none-any.whl"
"sourmash-4.8.8-py3-none-pyodide_2024_0_wasm32.whl"
"sparseqr-1.2-cp312-cp312-pyodide_2024_0_wasm32.whl"
"SQLAlchemy-2.0.29-cp312-cp312-pyodide_2024_0_wasm32.whl"
"sqlalchemy-tests.tar"
"sqlite3-1.0.0.zip"
"ssl-1.0.0.zip"
"stack_data-0.6.3-py3-none-any.whl"
"statsmodels-0.14.2-cp312-cp312-pyodide_2024_0_wasm32.whl"
"statsmodels-tests.tar"
"strictyaml-1.7.3-py3-none-any.whl"
"suitesparse-5.11.0.zip"
"svgwrite-1.4.3-py3-none-any.whl"
"swiglpk-5.0.10-cp312-cp312-pyodide_2024_0_wasm32.whl"
"sympy-1.12-py3-none-any.whl"
"sympy-tests.tar"
"tblib-3.0.0-py3-none-any.whl"
"termcolor-2.4.0-py3-none-any.whl"
"test-1.0.0.zip"
"texttable-1.7.0-py2.py3-none-any.whl"
"threadpoolctl-3.4.0-py3-none-any.whl"
"tomli-2.0.1-py3-none-any.whl"
"tomli_w-1.0.0-py3-none-any.whl"
"toolz-0.12.1-py3-none-any.whl"
"toolz-tests.tar"
"tqdm-4.66.2-py3-none-any.whl"
"traitlets-5.14.3-py3-none-any.whl"
"traitlets-tests.tar"
"traits-6.4.3-cp312-cp312-pyodide_2024_0_wasm32.whl"
"traits-tests.tar"
"tskit-0.5.6-cp312-cp312-pyodide_2024_0_wasm32.whl"
"typing_extensions-4.11.0-py3-none-any.whl"
"tzdata-2024.1-py2.py3-none-any.whl"
"uncertainties-3.1.7-py2.py3-none-any.whl"
"uncertainties-tests.tar"
"unyt-3.0.2-py3-none-any.whl"
"unyt-tests.tar"
"urllib3-2.2.1-py3-none-any.whl"
"wcwidth-0.2.13-py2.py3-none-any.whl"
"webencodings-0.5.1-py2.py3-none-any.whl"
"wordcloud-1.9.3-cp312-cp312-pyodide_2024_0_wasm32.whl"
"wrapt-1.16.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"xarray-2024.3.0-py3-none-any.whl"
"xarray-tests.tar"
"xgboost-2.1.0.dev0-py3-none-pyodide_2024_0_wasm32.whl"
"xlrd-2.0.1-py2.py3-none-any.whl"
"xxhash-3.4.1-cp312-cp312-pyodide_2024_0_wasm32.whl"
"xyzservices-2024.4.0-py3-none-any.whl"
"xyzservices-tests.tar"
"yarl-1.9.4-cp312-cp312-pyodide_2024_0_wasm32.whl"
"yt-4.3.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
"zarr-2.16.1-py3-none-any.whl"
"zarr-tests.tar"
"zengl-2.4.1-cp311-abi3-pyodide_2024_0_wasm32.whl"
"zstandard-0.22.0-cp312-cp312-pyodide_2024_0_wasm32.whl"
)

# Create the static/pyodide directory if it doesn't exist
mkdir -p ./static/pyodide/

# Download each file if it doesn't already exist
for file in "${FILES[@]}"
do
    if [ -f "./static/pyodide/$file" ]; then
        echo "$file already exists in static/pyodide/, skipping download."
        continue
    fi

    echo "Downloading $file..."
    wget -P ./static/pyodide/ "${BASE_URL}${file}"

    # Check if the download was successful
    if [[ $? -ne 0 ]]; then
        echo "Failed to download $file"
    else
        echo "$file downloaded successfully."
    fi
done

echo "All missing files are now present in the static/pyodide/ directory."
